import{r as C,u as w,j as e,I as K,B as x,T as Y,E as q,F as v,G as N,H as Q,J as y,x as p,d as h,v as g,q as b,a as V,K as T,M as P,N as F,O as I,Q as M,R as E,U as $,V as z,W as U,Y as le,Z as de,_ as oe,$ as he,a0 as O,a1 as H,a2 as B,a3 as _,a4 as Z,i as se,k as ae,l as te,m as ne,n as G,a5 as xe,a6 as ee,a7 as me,a8 as je,a9 as ue,aa as ge,ab as pe,ac as ye,ad as J,L as fe}from"./index-Xj3-ztsO.js";import{C as A,a as D,b as S,c as R,d as k}from"./card-DpOJR0o6.js";import{u as L}from"./use-mobile-NC1PIFpa.js";import{E as ve}from"./EmptyState-DTePYbNB.js";import{P as Ne}from"./PageHeader-C4PCHSjN.js";const Ce=()=>{const[a,d]=C.useState({}),[s,i]=C.useState(""),[l,o]=C.useState(""),t=L(),n=w(()=>h.settings.get("exchangeRates"));C.useEffect(()=>{n&&n.value&&d(n.value)},[n]);const u=async()=>{const c=s.toUpperCase().trim(),f=parseFloat(l);if(!c||c.length!==3){p("Please enter a valid 3-letter currency code (e.g., USD).");return}if(isNaN(f)||f<=0){p("Please enter a valid positive exchange rate.");return}if(c==="CAD"){p("Cannot set a rate for the base currency (CAD).");return}const W={...a,[c]:f};try{await h.settings.put({key:"exchangeRates",value:W}),g.info(`Exchange rate for ${c} added/updated.`,{newRate:f}),b(`Rate for ${c} saved successfully!`),i(""),o("")}catch(X){g.error("Failed to save exchange rate",{error:X}),p("Failed to save exchange rate.")}},r=async c=>{const{[c]:f,...W}=a;try{await h.settings.put({key:"exchangeRates",value:W}),g.info(`Exchange rate for ${c} removed.`),b(`Rate for ${c} removed.`)}catch(X){g.error("Failed to remove exchange rate",{error:X}),p("Failed to remove exchange rate.")}},m=()=>e.jsx("div",{className:"space-y-3",children:Object.entries(a).map(([c,f])=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.toLocaleString("en-US",{style:"currency",currency:"CAD"})})]}),e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>r(c),children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})]},c))}),j=()=>e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(q,{children:e.jsxs(v,{children:[e.jsx(N,{children:"Currency"}),e.jsx(N,{children:"1 Unit of Currency equals..."}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:Object.entries(a).map(([c,f])=>e.jsxs(v,{children:[e.jsx(y,{className:"font-medium",children:c}),e.jsx(y,{children:f.toLocaleString("en-US",{style:"currency",currency:"CAD"})}),e.jsx(y,{className:"text-right",children:e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>r(c),children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})})]},c))})]})});return e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"Exchange Rates"}),e.jsx(R,{children:"Manage exchange rates for foreign currencies. All rates should be relative to CAD (e.g., 1 USD = X CAD)."})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[e.jsx(K,{placeholder:"Currency (e.g., USD)",value:s,onChange:c=>i(c.target.value),maxLength:3}),e.jsx(K,{type:"number",placeholder:"Rate (to CAD)",value:l,onChange:c=>o(c.target.value)}),e.jsx(x,{onClick:u,className:"w-full sm:w-auto",children:"Add / Update Rate"})]}),Object.keys(a).length>0?t?m():j():e.jsx("div",{className:"text-center h-24 flex items-center justify-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No custom exchange rates set."})})]})]})},re=()=>{const a=L(),{openPayeeDialog:d}=V(),s=w(()=>h.payees.orderBy("name").toArray()),i=w(()=>h.categories.toArray()),l=new Map(i==null?void 0:i.map(r=>[r.id,r.name])),o=r=>{d(r)},t=async r=>{try{await h.payees.delete(r),g.info(`Payee ${r} deleted.`),b("Payee deleted successfully.")}catch(m){g.error(`Failed to delete payee ${r}`,{error:m}),p("Failed to delete payee.")}},n=()=>e.jsx("div",{className:"space-y-3",children:s==null?void 0:s.map(r=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Default Category: ",r.defaultCategoryId?l.get(r.defaultCategoryId):"N/A"]})]}),e.jsxs("div",{className:"flex",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>o(r),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the payee "',r.name,'".']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>t(r.id),children:"Delete"})]})]})]})]})]},r.id))}),u=()=>e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(q,{children:e.jsxs(v,{children:[e.jsx(N,{children:"Name"}),e.jsx(N,{children:"Default Category"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:s&&s.length>0?s.map(r=>e.jsxs(v,{children:[e.jsx(y,{className:"font-medium",children:r.name}),e.jsx(y,{children:r.defaultCategoryId?l.get(r.defaultCategoryId):"N/A"}),e.jsxs(y,{className:"text-right",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>o(r),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the payee "',r.name,'".']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>t(r.id),children:"Delete"})]})]})]})]})]},r.id)):e.jsx(v,{children:e.jsx(y,{colSpan:3,className:"text-center h-24",children:"No payees created yet."})})})]})});return e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Payee Management"}),e.jsx(R,{children:"Manage your list of payees and their default categories."})]}),e.jsxs(x,{onClick:()=>o(),className:"w-full sm:w-auto",children:[e.jsx("span",{className:"mr-2",children:"➕"}),"Add Payee"]})]})}),e.jsx(k,{children:s&&s.length>0?a?n():u():e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-muted-foreground",children:"No payees created yet."})})})]})})},ie=["contains","is","starts_with","ends_with"],we=oe({name:ee().min(2,{message:"Rule name must be at least 2 characters."}),operator:me(ie),conditionValue:ee().min(1,{message:"Please enter a value to match."}),categoryId:ee().min(1,{message:"Please select a category."})}),be=({onSubmit:a,onCancel:d,initialValues:s,submitButtonText:i="Save"})=>{var n,u,r,m;const{openCategoryDialog:l}=V(),o=w(()=>h.categories.orderBy("name").toArray(),[]),t=le({resolver:de(we),defaultValues:{name:(s==null?void 0:s.name)||"",operator:((n=s==null?void 0:s.condition)==null?void 0:n.operator)||"contains",conditionValue:((u=s==null?void 0:s.condition)==null?void 0:u.value)||"",categoryId:((m=(r=s==null?void 0:s.actions)==null?void 0:r[0])==null?void 0:m.value.categoryId.toString())||void 0}});return e.jsx(he,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(a),className:"space-y-4",children:[e.jsx(O,{control:t.control,name:"name",render:({field:j})=>e.jsxs(H,{children:[e.jsx(B,{children:"Rule Name"}),e.jsx(_,{children:e.jsx(K,{placeholder:"e.g., Starbucks Coffee",...j,autoFocus:!0})}),e.jsx(Z,{})]})}),e.jsx("p",{className:"text-sm font-medium",children:"Condition"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 border rounded-md",children:[e.jsxs(H,{children:[e.jsx(B,{children:"IF description..."}),e.jsx(O,{control:t.control,name:"operator",render:({field:j})=>e.jsxs(se,{onValueChange:j.onChange,value:j.value,children:[e.jsx(_,{children:e.jsx(ae,{children:e.jsx(te,{})})}),e.jsx(ne,{children:ie.map(c=>e.jsx(G,{value:c,children:c.replace(/_/g," ")},c))})]})})]}),e.jsx(O,{control:t.control,name:"conditionValue",render:({field:j})=>e.jsxs(H,{children:[e.jsx(B,{children:"Value"}),e.jsx(_,{children:e.jsx(K,{placeholder:"e.g., Starbucks",...j})}),e.jsx(Z,{})]})})]}),e.jsx("p",{className:"text-sm font-medium",children:"Action"}),e.jsx("div",{className:"p-4 border rounded-md",children:e.jsx(O,{control:t.control,name:"categoryId",render:({field:j})=>e.jsxs(H,{children:[e.jsx(B,{children:"THEN set category to..."}),e.jsxs(se,{onValueChange:c=>{c==="add-new"?l():j.onChange(c)},value:j.value,children:[e.jsx(_,{children:e.jsx(ae,{children:e.jsx(te,{placeholder:"Select a category"})})}),e.jsxs(ne,{children:[o==null?void 0:o.map(c=>e.jsx(G,{value:c.id.toString(),children:c.name},c.id)),e.jsx(xe,{}),e.jsx(G,{value:"add-new",children:e.jsx("span",{className:"font-medium text-primary",children:"➕ Add new category..."})})]})]}),e.jsx(Z,{})]})})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:d,children:"Cancel"}),e.jsx(x,{type:"submit",children:i})]})]})})},Ae=({rule:a,isOpen:d,onClose:s})=>{const i=!!(a!=null&&a.id),l=async o=>{try{const t={name:o.name,condition:{field:"description",operator:o.operator,value:o.conditionValue},actions:[{type:"set_category",value:{categoryId:parseInt(o.categoryId,10)}}]};i&&a.id?(await h.rules.update(a.id,t),g.info("Rule updated",{id:a.id,...t}),b(`Rule "${o.name}" updated successfully!`)):(await h.rules.add({...t,createdAt:new Date}),g.info("Rule added",t),b(`Rule "${o.name}" created successfully!`)),s()}catch(t){const n=i?"update":"add";g.error(`Failed to ${n} rule`,{error:t,values:o}),p("Failed to save rule. Does a rule with that name already exist?")}};return e.jsx(je,{open:d,onOpenChange:s,children:e.jsxs(ue,{children:[e.jsxs(ge,{children:[e.jsxs(pe,{children:[i?"Edit":"Add New"," Rule"]}),e.jsx(ye,{children:i?"Update this automation rule.":"Create a rule to automatically categorize transactions."})]}),e.jsx(be,{onSubmit:l,onCancel:s,initialValues:a||void 0,submitButtonText:i?"Save Changes":"Add Rule"})]})})},De=({rule:a,onEdit:d,onDelete:s})=>{const{condition:i,actions:l,name:o}=a,t=w(()=>h.categories.get(l[0].value.categoryId),[l[0].value.categoryId]);return e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(S,{children:o}),e.jsxs(R,{children:["IF description ",e.jsx("span",{className:"font-semibold text-primary",children:i.operator.replace(/_/g," ")}),' "',i.value,'"']})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("p",{className:"text-sm",children:["THEN set category to ",e.jsx("span",{className:"font-semibold text-primary",children:(t==null?void 0:t.name)||"..."})]}),e.jsxs("div",{className:"flex",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>d(a),children:[e.jsx("span",{className:"mr-1",children:"✏️"})," Edit"]}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsxs(x,{variant:"ghost",size:"sm",className:"text-destructive hover:text-destructive",children:[e.jsx("span",{className:"mr-1",children:"🗑️"})," Delete"]})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the rule "',a.name,'". This action cannot be undone.']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>s(a.id),children:"Delete"})]})]})]})]})]})})]})},Se=()=>{const[a,d]=C.useState(!1),[s,i]=C.useState(null),l=w(()=>h.rules.toArray()),[o,t]=J(),n=m=>{i(m||null),d(!0)},u=()=>{i(null),d(!1)};C.useEffect(()=>{const m=o.get("description"),j=o.get("categoryId");if(m&&j){const c={name:m,condition:{field:"description",operator:"contains",value:m},actions:[{type:"set_category",value:{categoryId:parseInt(j,10)}}]};n(c);const f=new URLSearchParams(o);f.delete("description"),f.delete("categoryId"),t(f,{replace:!0})}},[o,t]);const r=async m=>{try{await h.rules.delete(m),g.info(`Rule ${m} deleted.`),b("Rule deleted successfully.")}catch(j){g.error(`Failed to delete rule ${m}`,{error:j}),p("Failed to delete rule.")}};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Automation Rules"}),e.jsx(R,{children:"Create rules to automatically categorize your transactions during import or when run manually."})]}),e.jsxs(x,{onClick:()=>n(),children:[e.jsx("span",{className:"mr-2",children:"➕"}),"Create Rule"]})]})}),e.jsx(k,{children:l&&l.length>0?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-3",children:l.map(m=>e.jsx(De,{rule:m,onEdit:n,onDelete:r},m.id))}):e.jsx(ve,{icon:"📜",title:"No Rules Yet",description:"Create rules to automatically categorize your transactions.",action:{text:"Create Your First Rule",onClick:()=>n()}})})]}),e.jsx(Ae,{isOpen:a,onClose:u,rule:s})]})},Re=()=>{const a=L(),{openTagDialog:d}=V(),s=w(()=>h.tags.orderBy("name").toArray()),i=async t=>{try{await h.transaction("rw",h.tags,h.transactions,async()=>{const u=(await h.transactions.where("tags").equals(t).toArray()).map(r=>{var m;return{key:r.id,changes:{tags:(m=r.tags)==null?void 0:m.filter(j=>j!==t)}}});u.length>0&&await h.transactions.bulkUpdate(u),await h.tags.delete(t)}),g.info(`Tag ${t} deleted and removed from transactions.`),b("Tag deleted successfully.")}catch(n){g.error(`Failed to delete tag ${t}`,{error:n}),p("Failed to delete tag.")}},l=()=>e.jsx("div",{className:"space-y-3",children:s==null?void 0:s.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsxs("div",{className:"flex",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>d(t),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the tag "',t.name,'" and remove it from all transactions.']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>i(t.id),children:"Delete"})]})]})]})]})]},t.id))}),o=()=>e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(q,{children:e.jsxs(v,{children:[e.jsx(N,{children:"Name"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:s&&s.length>0?s.map(t=>e.jsxs(v,{children:[e.jsx(y,{className:"font-medium",children:t.name}),e.jsxs(y,{className:"text-right",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>d(t),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the tag "',t.name,'" and remove it from all transactions.']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>i(t.id),children:"Delete"})]})]})]})]})]},t.id)):e.jsx(v,{children:e.jsx(y,{colSpan:2,className:"text-center h-24",children:"No tags created yet."})})})]})});return e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Tag Management"}),e.jsx(R,{children:"Create and manage tags to group transactions for budgeting and analysis."})]}),e.jsxs(x,{onClick:()=>d(),className:"w-full sm:w-auto",children:[e.jsx("span",{className:"mr-2",children:"➕"}),"Add Tag"]})]})}),e.jsx(k,{children:s&&s.length>0?a?l():o():e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-muted-foreground",children:"No tags created yet."})})})]})})},ke=()=>{const a=L(),{openCategoryDialog:d}=V(),s=w(()=>h.categories.orderBy("name").toArray()),i=C.useMemo(()=>new Map(s==null?void 0:s.map(n=>[n.id,n.name])),[s]),l=async n=>{try{const u=await h.categories.where({parentId:n}).count();if(u>0){p(`Cannot delete: This category is a parent to ${u} other categor${u>1?"ies":"y"}.`);return}const r=await h.transactions.where({categoryId:n}).count();if(r>0){p(`Cannot delete: This category is used by ${r} transaction(s).`);return}const m=await h.payees.where({defaultCategoryId:n}).count();if(m>0){p(`Cannot delete: This category is the default for ${m} payee(s).`);return}await h.categories.delete(n),g.info(`Category ${n} deleted.`),b("Category deleted successfully.")}catch(u){g.error(`Failed to delete category ${n}`,{error:u}),p("Failed to delete category.")}},o=()=>e.jsx("div",{className:"space-y-3",children:s==null?void 0:s.map(n=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:n.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Parent: ",n.parentId?i.get(n.parentId):"N/A"]})]}),e.jsxs("div",{className:"flex",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>d(n),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the category "',n.name,'".']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>l(n.id),children:"Delete"})]})]})]})]})]},n.id))}),t=()=>e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs(Y,{children:[e.jsx(q,{children:e.jsxs(v,{children:[e.jsx(N,{children:"Name"}),e.jsx(N,{children:"Parent Category"}),e.jsx(N,{className:"text-right",children:"Actions"})]})}),e.jsx(Q,{children:s&&s.length>0?s.map(n=>e.jsxs(v,{children:[e.jsx(y,{className:"font-medium",children:n.name}),e.jsx(y,{children:n.parentId?i.get(n.parentId):"N/A"}),e.jsxs(y,{className:"text-right",children:[e.jsx(x,{variant:"ghost",size:"icon",onClick:()=>d(n),children:"✏️"}),e.jsxs(T,{children:[e.jsx(P,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"icon",children:e.jsx("span",{className:"text-destructive",children:"🗑️"})})}),e.jsxs(F,{children:[e.jsxs(I,{children:[e.jsx(M,{children:"Are you sure?"}),e.jsxs(E,{children:['This will permanently delete the category "',n.name,'".']})]}),e.jsxs($,{children:[e.jsx(z,{children:"Cancel"}),e.jsx(U,{onClick:()=>l(n.id),children:"Delete"})]})]})]})]})]},n.id)):e.jsx(v,{children:e.jsx(y,{colSpan:3,className:"text-center h-24",children:"No categories created yet."})})})]})});return e.jsx(e.Fragment,{children:e.jsxs(A,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{children:"Category Management"}),e.jsx(R,{children:"Manage your spending and income categories, including sub-categories."})]}),e.jsxs(x,{onClick:()=>d(),className:"w-full sm:w-auto",children:[e.jsx("span",{className:"mr-2",children:"➕"}),"Add Category"]})]})}),e.jsx(k,{children:s&&s.length>0?a?o():t():e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-muted-foreground",children:"No categories created yet."})})})]})})},ce=[{id:"payees",name:"Payees"},{id:"categories",name:"Categories"},{id:"tags",name:"Tags"},{id:"rules",name:"Rules"},{id:"currencies",name:"Currencies"},{id:"api-keys",name:"API Keys"}],Te=()=>{const[a,d]=J(),s=a.get("tab")||"payees";return e.jsx("nav",{className:"flex flex-col space-y-1",children:ce.map(i=>e.jsx(x,{variant:s===i.id?"secondary":"ghost",className:"w-full justify-start",onClick:()=>d({tab:i.id}),children:i.name},i.id))})},Pe=()=>{const[a,d]=J(),s=a.get("tab")||"payees",i=l=>{d({tab:l})};return e.jsxs(se,{value:s,onValueChange:i,children:[e.jsx(ae,{children:e.jsx(te,{placeholder:"Select a setting"})}),e.jsx(ne,{children:ce.map(l=>e.jsx(G,{value:l.id,children:l.name},l.id))})]})},Fe=({children:a})=>L()?e.jsxs("div",{className:"space-y-4",children:[e.jsx(Pe,{}),e.jsx("div",{children:a})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 gap-8",children:[e.jsx("aside",{className:"md:col-span-1",children:e.jsx(Te,{})}),e.jsx("main",{className:"md:col-span-3 lg:col-span-4",children:a})]}),Ie=()=>{const[a,d]=C.useState(""),s=w(()=>h.settings.get("geminiApiKey"),[]);C.useEffect(()=>{s&&d(s.value||"")},[s]);const i=async()=>{try{await h.settings.put({key:"geminiApiKey",value:a}),g.info("Gemini API key updated."),b("API Key saved successfully!")}catch(l){g.error("Failed to save API key",{error:l}),p("Failed to save API key.")}};return e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"API Keys"}),e.jsx(R,{children:"Manage your API keys for third-party integrations. This data is stored securely on your device."})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"gemini-key",className:"font-medium",children:"Google Gemini API Key"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Used for AI-powered suggestions. You can get a free key from Google AI Studio."}),e.jsx(K,{id:"gemini-key",type:"password",value:a,onChange:l=>d(l.target.value),placeholder:"Enter your Gemini API key"})]}),e.jsx(x,{onClick:i,children:"Save API Key"})]})]})},Me=[{to:"/scheduled",icon:"🗓️",text:"Scheduled Transactions"},{to:"/reports",icon:"📊",text:"Reports"},{to:"/debug",icon:"🐞",text:"Debug Panel"}],Ee=()=>e.jsxs(A,{children:[e.jsxs(D,{children:[e.jsx(S,{children:"More"}),e.jsx(R,{children:"Access other application pages and tools."})]}),e.jsx(k,{children:e.jsx("div",{className:"space-y-2",children:Me.map(a=>e.jsx(x,{asChild:!0,variant:"outline",className:"w-full justify-start",children:e.jsxs(fe,{to:a.to,children:[e.jsx("span",{className:"mr-4 text-lg",children:a.icon}),a.text]})},a.to))})})]}),Oe=()=>{const[a]=J(),d=a.get("tab")||"payees",s=()=>{switch(d){case"payees":return e.jsx(re,{});case"categories":return e.jsx(ke,{});case"tags":return e.jsx(Re,{});case"rules":return e.jsx(Se,{});case"currencies":return e.jsx(Ce,{});case"api-keys":return e.jsx(Ie,{});default:return e.jsx(re,{})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ne,{title:"Settings ⚙️"}),e.jsx(Fe,{children:s()}),e.jsx(Ee,{})]})};export{Oe as default};
