import{A as S,D as N,u as g,d as x,r as w,j as e,S as u,f as F,T as W,E,F as M,G as f,H,J as p}from"./index-DwbuEFEH.js";import{B as K,I as z}from"./IncomeVsExpenseChart-CPXTc6Xl.js";import{C,a as b,b as v,c as D,d as T}from"./card-DdU8Mv6S.js";import{R as L,C as k,X as R,Y as B,T as I,B as O,L as Y,a as $}from"./generateCategoricalChart-Bn-IwpwC.js";import{L as G,a as P}from"./LineChart-DVBxMQAG.js";import{s as X}from"./subMonths-BzZ8L5dA.js";import{P as J}from"./PageHeader-rIQwqtJA.js";const Q=()=>{const c=new Date,h=S(c),r=N(c),l=g(()=>x.transactions.where("date").between(h,r).and(a=>a.amount<0).toArray(),[h.getTime(),r.getTime()]),n=g(()=>x.categories.toArray()),o=w.useMemo(()=>{if(!l||!n)return null;const a=new Map(n.map(t=>[t.id,t.name])),i=new Map;return l.forEach(t=>{const s=t.categoryId&&a.get(t.categoryId)||"Uncategorized",m=i.get(s)||0;i.set(s,m+Math.abs(t.amount))}),Array.from(i.entries()).map(([t,s])=>({name:t,value:s})).sort((t,s)=>s.value-t.value)},[l,n]);return e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(v,{children:"Category Spending"}),e.jsx(D,{children:"Your spending breakdown for the current month."})]}),e.jsx(T,{children:o?o.length>0?e.jsx("div",{className:"w-full h-96",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(K,{data:o,layout:"vertical",margin:{left:25},children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(R,{type:"number",tickFormatter:a=>`$${a}`}),e.jsx(B,{type:"category",dataKey:"name",width:100}),e.jsx(I,{formatter:a=>a.toLocaleString("en-US",{style:"currency",currency:"CAD"})}),e.jsx(O,{dataKey:"value",fill:"#8884d8",name:"Spending",children:e.jsx(Y,{dataKey:"value",position:"right",formatter:a=>a.toLocaleString("en-US",{style:"currency",currency:"CAD"})})})]})})}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No spending data for this month."})}):e.jsx(u,{className:"h-96 w-full"})})]})},V=()=>{const c=g(async()=>{const r=await x.transactions.orderBy("date").toArray(),l=await x.accounts.toArray(),n=await x.settings.get("exchangeRates"),o=(n==null?void 0:n.value)||{};return{transactions:r,accounts:l,exchangeRates:o}},[]),h=w.useMemo(()=>{if(!c||c.transactions.length===0||c.accounts.length===0)return null;const{transactions:r,accounts:l,exchangeRates:n}=c,o=[],a=new Date;for(let i=11;i>=0;i--){const t=X(a,i),s=N(t),m=F(t,"MMM yyyy"),U=r.filter(d=>new Date(d.date)<=s),j={};for(const d of U)j[d.accountId]=(j[d.accountId]||0)+d.amount;let y=0;for(const d of l){const A=j[d.id]||0;d.currency==="CAD"?y+=A:n[d.currency]&&(y+=A*n[d.currency])}o.push({name:m,netWorth:parseFloat(y.toFixed(2))})}return o},[c]);return e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(v,{children:"Net Worth Over Time"}),e.jsx(D,{children:"Your total net worth across all accounts for the last 12 months."})]}),e.jsx(T,{children:h?h.length>1?e.jsx("div",{className:"w-full h-96",children:e.jsx(L,{width:"100%",height:"100%",children:e.jsxs(G,{data:h,children:[e.jsx(k,{strokeDasharray:"3 3"}),e.jsx(R,{dataKey:"name"}),e.jsx(B,{tickFormatter:r=>`$${(r/1e3).toFixed(0)}k`}),e.jsx(I,{formatter:r=>r.toLocaleString("en-US",{style:"currency",currency:"CAD"})}),e.jsx($,{}),e.jsx(P,{type:"monotone",dataKey:"netWorth",stroke:"#8884d8",name:"Net Worth",strokeWidth:2,dot:{r:4}})]})})}):e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Not enough historical data to generate a chart."})}):e.jsx(u,{className:"h-96 w-full"})})]})},q=()=>{const c=new Date,h=S(c),r=N(c),l=g(()=>x.transactions.where("date").between(h,r).and(a=>a.amount<0).toArray(),[h.getTime(),r.getTime()]),n=g(()=>x.categories.toArray()),o=w.useMemo(()=>{if(!l||!n)return null;const a=new Map(n.map(t=>[t.id,t.name])),i=new Map;return l.forEach(t=>{const s=t.categoryId&&a.get(t.categoryId)||"Uncategorized",m=i.get(s)||{total:0,count:0};m.total+=Math.abs(t.amount),m.count+=1,i.set(s,m)}),Array.from(i.entries()).map(([t,s])=>({name:t,...s})).sort((t,s)=>s.total-t.total)},[l,n]);return e.jsxs(C,{children:[e.jsxs(b,{children:[e.jsx(v,{children:"Spending by Category"}),e.jsx(D,{children:"A detailed breakdown of your spending for the current month."})]}),e.jsx(T,{children:o?o.length>0?e.jsxs(W,{children:[e.jsx(E,{children:e.jsxs(M,{children:[e.jsx(f,{children:"Category"}),e.jsx(f,{className:"text-center",children:"Transactions"}),e.jsx(f,{className:"text-right",children:"Total Spent"})]})}),e.jsx(H,{children:o.map(a=>e.jsxs(M,{children:[e.jsx(p,{className:"font-medium",children:a.name}),e.jsx(p,{className:"text-center",children:a.count}),e.jsx(p,{className:"text-right font-mono",children:a.total.toLocaleString("en-US",{style:"currency",currency:"CAD"})})]},a.name))})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No spending data for this month."}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{className:"h-8 w-full"}),e.jsx(u,{className:"h-8 w-full"}),e.jsx(u,{className:"h-8 w-full"})]})})]})},re=()=>e.jsxs(e.Fragment,{children:[e.jsx(J,{title:"Reports ðŸ“Š"}),e.jsxs("div",{className:"grid gap-6 grid-cols-1 xl:grid-cols-2",children:[e.jsx("div",{className:"xl:col-span-2",children:e.jsx(V,{})}),e.jsx("div",{className:"xl:col-span-2",children:e.jsx(z,{})}),e.jsx("div",{className:"xl:col-span-1",children:e.jsx(Q,{})}),e.jsx("div",{className:"xl:col-span-1",children:e.jsx(q,{})})]})]});export{re as default};
